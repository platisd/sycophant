# sycophant

Generate articles based on the latest news, using OpenAI's models.

![sycophant](sycophant-logo.png)

## What

`sycophant` is a tool that generates articles based on the latest news, utilizing OpenAI's APIs,
for text completion and image generation.
Sycophants in ancient Greece were slanderers, revealing petty crimes such as stealing figs.
In English, the word has come to mean a person who tells others what they want to hear, to gain some advantage.<br>
`sycophant` will generate an article based on the latest news, on the subject of your choosing.
However, since you are in control of the exact prompt that will be used for the generation,
it may be telling you what you want to hear. Does it have an advantage to gain? You decide. üòè

## Why

To be honest, `sycophant` is more of a gimmick at this point, or at least that's how I am personallyusing it.<br>
As the proud owner of the domain name [robots.army](https://robots.army/), I always wanted to have some sort of
news aggregator on the theme of robots.
At first I started with the [@RobotsArmy](https://twitter.com/RobotsArmy) Twitter bot, but it got banned. ü§£<br>
Now that OpenAI have opened up so many possibilities, what better way to create a fully autonomous news aggregator,
that generates its own, relatively authentic, content?

## How

`sycophant` is a [Python script](sycophant.py) that does the following:
1. Fetches the latest news on a subject, using the [News API](https://newsapi.org/) (free tier)
   * The user selects the subject and how old the news should be
1. Summarizes the top news, using OpenAI's [completion](https://platform.openai.com/docs/api-reference/completions) API
   * The user selects how many articles to summmarize, the model to use, the prompt and the temperature
1. Generates an article based on the summaries, using OpenAI's [completion](https://platform.openai.com/docs/api-reference/completions) API
   * The user selects the prompt
1. Generates tags for the article, using OpenAI's [completion](https://platform.openai.com/docs/api-reference/completions) API
1. Generates a prompt, based on the article, to be used for image generation, using OpenAI's [completion](https://platform.openai.com/docs/api-reference/completions) API
   * The user selects the prompt to generate... the prompt
1. Generates an image based on the prompt, using OpenAI's [image](https://platform.openai.com/docs/api-reference/images) API
1. Creates a markdown file with the article, the image and the tags
   * The user provides a [Jinja](https://realpython.com/primer-on-jinja-templating/) template for the markdown file

`sycophant` assumes [Jekyll](https://jekyllrb.com/) is used for static site generation.
You can see an example of a website automatically generated by `sycophant` at [platisd/robots.army](https://github.com/platisd/robots.army).

## Get started

The most difficult part of starting to use `sycophant` is -surprise, surprise- figuring out the optimum prompts.
That and possibly making some adjustments to the script if you use a different setup than the one described above.
Your best bet is to get inspired from [platisd/robots.army](https://github.com/platisd/robots.army) but, nonetheless,
let's go over the different things you would need to do.

### Prerequisites

Before running `sycophant` you need the following:

1. Install Python dependencies `pip install -r requirements.txt`
1. Get an API key for the [News API](https://newsapi.org/)
1. Get an API key for the [OpenAI API](https://openai.com/pricing)

### Configuration YAML

Aside of the API keys which need to be provided as arguments to the script, the rest of the configuration is done
through a YAML file. You can see an example of such a file at [sycophant-config.yaml](sycophant-config.yaml).
The path to the configuration file is also provided as an argument to the script.<br>
Let's take a look at the configuration file's compulsory fields:

| Field                           | Details                                                           | Notes                             |
| ------------------------------- | ----------------------------------------------------------------- | --------------------------------- |
| `openai/model`                  | The model to use for all text completion queries                  | [Models overview]                 |
| `openai/max_tokens`             | The maximum number of tokens for each prompt, controls the length | Varies by the model               |
| `openai/temperature`            | The temperature to use for all text completion queries            | Value between 0-2                 |
| `openai/article_summary_prompt` | The prompt to use for summarizing the different articles          |                                   |
| `openai/final_article_prompt`   | The prompt to use for generating the final (published) article    |                                   |
| `openai/dalle_prompt`           | The prompt to use for generating the image with Dall-E            |                                   |
| `news/topic`                    | The topic to use for fetching the latest news                     | [Advanced queries] supported      |
| `news/max_age_in_days`          | The maximum age of the news to fetch                              | Free-tier has limits on age       |
| `news/max_articles`             | The maximum number of articles to fetch and summarize             | More articles, larger GPT prompts |
| `blog/assets`                   | The path to where you want your images to be placed               |                                   |
| `blog/posts`                    | The path to where you want your markdown files to be placed       |                                   |
| `blog/post_template`            | The path to the Jinja template to use for the markdown files      |                                   |


[Models overview]: https://platform.openai.com/docs/models/overview
[Advanced queries]: https://newsapi.org/docs/endpoints/everything

Careful tuning of the prompts will give you seamless operation (i.e. no failure because of too large prompts)
and better results when it comes to the generated text and images.
You can start from the sample ones and iterate from there.
Don't forget to catch up on [GPT best practices](https://platform.openai.com/docs/guides/gpt-best-practices).

### Automation

Once you are able to run `sycophant` and generate articles locally, you may automate the process and create
a website such as [robots.army](https://robots.army).<br>
If you use Jekyll and GitHub Actions you can refer to the setup at
[platisd/robots.army](https://github.com/platisd/robots.army/tree/master/.github/workflows).
You will need at least two workflows/pipelines:
1. The deployment pipeline which runs every time new articles are generated (e.g. by `git push`) and deploys the
   website to GitHub Pages. Check [pages-deploy.yml].
2. The "build" pipeline which periodically runs `sycophant` and generates articles. Refer to [sycophant.yml].

[pages-deploy.yml]: https://github.com/platisd/robots.army/blob/master/.github/workflows/pages-deploy.yml
[sycophant.yml]: https://github.com/platisd/robots.army/blob/master/.github/workflows/sycophant.yml

Remember that using `sycophant` is not free, as you need to pay for the OpenAI API.
Text completion is rather cheap, but not necessarily the image generation.
After all, it doesn't make sense to generate articles very frequently, unless you pick a topic where news are
constantly being published. Choose the frequency of your cron job wisely.<br>
The News API is free for developer usage but has limits on the number of requests per day and the age of the news.
